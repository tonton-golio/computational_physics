@import "tailwindcss";

@custom-variant dark (&:where(:root[data-theme="dark"], :root[data-theme="dark"] *));

:root {
  --background: #edf0f5;
  --foreground: #1a2235;
  --surface-1: #f5f6f9;
  --surface-2: #e4e8f0;
  --surface-3: #d8dde8;
  --border-strong: #bcc6da;
  --text-muted: #4a5a72;
  --text-soft: #657488;
  --text-strong: #1a2235;
  --accent: #2d56be;
  --accent-strong: #1c4290;
  --danger-surface: #f5edef;
  --danger-border: #e0b3be;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #070b14;
    --foreground: #e8edf8;
    --surface-1: #0d1322;
    --surface-2: #101a2d;
    --surface-3: #14233f;
    --border-strong: #2c4166;
    --text-muted: #a5b5d0;
    --text-soft: #7f94b6;
    --text-strong: #f4f7ff;
    --accent: #7bb0ff;
    --accent-strong: #9dc2ff;
    --danger-surface: #1a1122;
    --danger-border: #55314b;
  }
}

:root[data-theme="light"] {
  --background: #edf0f5;
  --foreground: #1a2235;
  --surface-1: #f5f6f9;
  --surface-2: #e4e8f0;
  --surface-3: #d8dde8;
  --border-strong: #bcc6da;
  --text-muted: #4a5a72;
  --text-soft: #657488;
  --text-strong: #1a2235;
  --accent: #2d56be;
  --accent-strong: #1c4290;
  --danger-surface: #f5edef;
  --danger-border: #e0b3be;
}

:root[data-theme="dark"] {
  --background: #070b14;
  --foreground: #e8edf8;
  --surface-1: #0d1322;
  --surface-2: #101a2d;
  --surface-3: #14233f;
  --border-strong: #2c4166;
  --text-muted: #a5b5d0;
  --text-soft: #7f94b6;
  --text-strong: #f4f7ff;
  --accent: #7bb0ff;
  --accent-strong: #9dc2ff;
  --danger-surface: #1a1122;
  --danger-border: #55314b;
}

body {
  background-color: var(--background);
  background-image: radial-gradient(circle at 20% 20%, rgba(45,86,190,0.25), transparent 45%),
                    radial-gradient(circle at 80% 70%, rgba(139,92,216,0.20), transparent 50%) !important;
  background-attachment: fixed;
  color: var(--foreground);
  font-family: var(--font-geist-sans), Inter, system-ui, -apple-system, sans-serif;
}

:root[data-theme="dark"] body {
  background-image: radial-gradient(circle at 20% 20%, rgba(56,189,248,0.08), transparent 35%),
                    radial-gradient(circle at 80% 70%, rgba(168,85,247,0.09), transparent 40%) !important;
}

@media (prefers-color-scheme: dark) {
  :root:not([data-theme="light"]) body {
    background-image: radial-gradient(circle at 20% 20%, rgba(56,189,248,0.08), transparent 35%),
                      radial-gradient(circle at 80% 70%, rgba(168,85,247,0.09), transparent 40%) !important;
  }
}

.markdown-content h1,
.markdown-content h2,
.markdown-content h3 {
  color: var(--text-strong);
}

.markdown-content p,
.markdown-content li {
  color: var(--text-muted);
}

.markdown-content a {
  color: var(--accent);
}

.markdown-content pre {
  background: var(--surface-2) !important;
  color: var(--foreground) !important;
  border: 1px solid var(--border-strong);
}

.markdown-content code {
  color: var(--accent-strong);
}

.markdown-content table {
  background: var(--surface-2) !important;
  border-color: var(--border-strong);
}

.markdown-content th,
.markdown-content td {
  border-color: var(--border-strong) !important;
  color: var(--text-muted) !important;
}

/* Collapsible sidebar grid */
.sidebar-grid {
  transition: grid-template-columns 300ms ease-in-out, gap 300ms ease-in-out;
}

@media (min-width: 1024px) {
  .sidebar-grid[data-collapsed="false"] {
    grid-template-columns: 320px minmax(0, 1fr);
    gap: 20px;
  }
  .sidebar-grid[data-collapsed="true"] {
    grid-template-columns: 0px minmax(0, 1fr);
    gap: 0px;
  }
}

/* Fullscreen simulation background */
:fullscreen {
  background-color: var(--surface-1);
}
:-webkit-full-screen {
  background-color: var(--surface-1);
}

/* ── Fullscreen simulation layout ─────────────────────────────────── */

/* Wrapper fills the fullscreen container */
.sim-fs-content {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

/*
 * Simulation root becomes a flex column pushed to the bottom.
 * Visual children (with canvas/video) are pulled out via position:absolute
 * so they fill the entire screen behind the flow content.
 */
.sim-fs-content > * {
  width: 100%;
  height: 100%;
  display: flex !important;
  flex-direction: column;
  justify-content: flex-end;
  align-items: flex-start;
  gap: 8px !important;
  padding: 12px;
  position: relative;
}

/* ── Visual children: fill the screen behind everything ── */
.sim-fs-content > * > *:has(canvas),
.sim-fs-content > * > *:has(video) {
  position: absolute !important;
  top: 44px; /* leave room for title */
  left: 50%;
  transform: translateX(-50%);
  z-index: 0;
  max-width: 100%;
  max-height: calc(100% - 44px);
  border-radius: 0 !important;
  border: none !important;
  overflow: hidden;
}

/* ── Non-visual, non-labeled children: overlay bottom-left ── */
.sim-fs-content > * > *:not(:has(canvas)):not(:has(video)):not([data-fs-role]) {
  position: relative;
  z-index: 5;
  max-width: min(360px, calc(100% - 24px));
  background: color-mix(in srgb, var(--surface-1) 80%, transparent);
  backdrop-filter: blur(12px);
  border-radius: 12px !important;
  border: 1px solid var(--border-strong);
  padding: 12px;
  pointer-events: auto;
  flex-shrink: 0;
}

/* ── Controls (Card, SimulationPanel): overlay bottom-left ── */
.sim-fs-content [data-fs-role="controls"] {
  position: relative;
  z-index: 5;
  max-width: min(360px, calc(100% - 24px));
  background: color-mix(in srgb, var(--surface-1) 80%, transparent) !important;
  backdrop-filter: blur(12px);
  pointer-events: auto;
  flex-shrink: 0;
}

/* ── Charts (CanvasChart): overlay bottom-right ── */
.sim-fs-content [data-fs-role="chart"] {
  position: absolute !important;
  bottom: 12px;
  right: 12px;
  z-index: 6;
  width: min(520px, 45vw) !important;
  background: color-mix(in srgb, var(--surface-1) 80%, transparent);
  backdrop-filter: blur(12px);
  border-radius: 12px !important;
  border: 1px solid var(--border-strong);
  padding: 8px;
  pointer-events: auto;
}

/* ── Fullscreen title overlay ── */
.sim-fs-title {
  position: absolute;
  top: 12px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-strong);
  background: color-mix(in srgb, var(--surface-1) 70%, transparent);
  backdrop-filter: blur(12px);
  border: 1px solid var(--border-strong);
  border-radius: 8px;
  padding: 6px 16px;
  white-space: nowrap;
  pointer-events: none;
}

/* Shimmer animation for loading skeletons */
@keyframes shimmer {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}
